import{r as c,e as w,g as y,h as b,j as e,F as r,L as m,B as v,A as u,f as h,i as S,k as C,l as T,m as i}from"./index-bbdbebe5.js";import{S as f}from"./sweetalert2.all-a660dd7e.js";const I="/assets/login-10052948.png";function P(){const[d,g]=c.useState(""),[x,p]=c.useState(""),[L,j]=c.useState(""),[k,n]=c.useState(!1),l=w(),o=y();b(t=>t.usertype);const N=async()=>{console.log("uesr check");const t=await u.getItem("manfa3aToken");h.post("/users/user_check_mobile",{token:t}).then(s=>{console.log(s),s.data.success&&(o(S(s.data.success.fullname)),o(C(s.data.success.usertype)),l("/home"))}).catch(s=>{console.log(s)})};c.useEffect(()=>{(async()=>{console.log("use efect from login");try{const s=await u.getItem("manfa3aToken");console.log(s),s&&(o(T(s)),j(s))}catch{}})(),N()},[d]);const _=()=>{n(!0);const t={username:d,password:x},s={"Content-Type":"application/json"};h.post("/users/login",t,{headers:s}).then(a=>{a.data.success?(n(!1),console.log(a.data.user_data.user_type),localStorage.setItem("manfa3aToken",a.data.user_data.token),localStorage.setItem("manfa3aProfile",a.data.user_data.user_img),a.data.user_data.user_type=="superadmin"?(o(i(!0)),window.location.href=`https://portal.infinitybridge.org?token=${a.data.user_data.token}`):a.data.user_data.user_type=="Admin"?(o(i(!1)),l("/admin")):a.data.user_data.user_type=="seller"?(o(i(!1)),l("/seller")):a.data.user_data.user_type=="marketer"&&(o(i(!1)),l("/marketer"))):a.data.error=="too_many_requests"?o(error_many(!0)):(l("/login"),n(!1),console.log(a.data),f.fire({title:"خطأ",text:a.data.error,icon:"error",timer:2e3,showConfirmButton:!1}))}).catch(a=>{n(!1),f.fire({title:"خطأ ",text:"خطأ",icon:"error",timer:2e3,showConfirmButton:!1})})};return e.jsx("div",{className:"login",children:e.jsx("div",{className:"container pt-5 ",children:e.jsxs("div",{className:"row pb-5 ",children:[e.jsx("div",{className:"col-12 col-md-6 d-md-block d-none",children:e.jsx("img",{className:"w-100",src:I,alt:"logo"})}),e.jsxs("div",{className:"col-12 float-end col-md-6 pt-5 text-end  text-white mt-5",children:[e.jsxs("div",{className:"mb-2",children:[e.jsxs("h1",{children:["مرحبا بك فى ",e.jsx("span",{className:"text-info",children:"منفعة"})," "]}),e.jsx("p",{className:"fw-bold",children:"قم بتسجيل الدخول إلى حسابك باستخدام اسم السمتخدم وكلمة المرور"})]}),e.jsxs(r,{className:" w-100 d-block ",dir:"rtl",children:[e.jsxs(r.Group,{className:"mb-3",controlId:"formBasicEmail",children:[e.jsx(r.Label,{children:"اسم المستخدم"}),e.jsx(r.Control,{className:"w-75  ",type:"text",placeholder:"ادخل اسم السمتخدم",onChange:t=>{g(t.target.value)}})]}),e.jsxs(r.Group,{className:"mb-3",controlId:"formBasicPassword",children:[e.jsx(r.Label,{children:"كلمة المرور"}),e.jsx(r.Control,{className:"w-75  ",type:"password",placeholder:"ادخل كلمة المرور",onChange:t=>{p(t.target.value)}})]}),e.jsxs("p",{children:["نسيت كلمة المرور؟ ",e.jsx(m,{className:"text-info",to:"/ForgetPassword",children:"استرجاع"})," "]}),e.jsx(v,{className:"ps-5 pe-5 fw-bold",variant:"primary",type:"button",onClick:_,children:k?e.jsx("div",{className:"spinner-border",role:"status",children:e.jsx("span",{className:"visually-hidden",children:" Loading..."})}):"الدخول"})]}),e.jsx("div",{className:" fw-bold",children:e.jsxs("p",{children:["لا يوجد لديك حساب؟ ",e.jsx(m,{className:"text-info",to:"/register",children:"التسجيل"})," "]})})]})]})})})}export{P as default};
